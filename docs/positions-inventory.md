# Positions Inventory

This document lists all positions currently stored and used in the VSQ Operations Manpower application.

**Last Updated:** 2026-01-18 12:14:29

---

## Summary

- **Total Positions:** 30 positions
- **English Positions:** 7 positions
- **Thai Positions:** 23 positions
- **Recently Added:** 3 positions (Front 3, Front Laser, Laser Assistant)

---

## All Positions (Sorted by Display Order)

### English Positions

| ID | Name | Min Staff/Branch | Revenue Multiplier | Display Order |
|----|------|------------------|-------------------|---------------|
| `10000000-0000-0000-0000-000000000001` | Branch Manager | 1 | 0.0 | 1 |
| `10000000-0000-0000-0000-000000000002` | Assistant Branch Manager | 0 | 0.5 | 2 |
| `10000000-0000-0000-0000-000000000003` | Service Consultant | 1 | 1.0 | 50 |
| `10000000-0000-0000-0000-000000000004` | Coordinator | 1 | 0.8 | 50 |
| `10000000-0000-0000-0000-000000000005` | Doctor Assistant | 2 | 1.2 | 20 |
| `10000000-0000-0000-0000-000000000006` | Physiotherapist | 1 | 1.0 | 30 |
| `10000000-0000-0000-0000-000000000007` | Nurse | 2 | 1.0 | 30 |
| `10000000-0000-0000-0000-000000000028` | Front 3 | 3 | 0.5 | 40 |
| `10000000-0000-0000-0000-000000000029` | Front Laser | 1 | 0.5 | 40 |
| `10000000-0000-0000-0000-000000000030` | Laser Assistant | 1 | 1.0 | 20 |

### Thai Positions

| ID | Name (Thai) | English Translation | Min Staff/Branch | Revenue Multiplier | Display Order |
|----|-------------|---------------------|------------------|-------------------|---------------|
| `10000000-0000-0000-0000-000000000008` | ผู้จัดการสาขา | Branch Manager | 1 | 0.0 | 1 |
| `10000000-0000-0000-0000-000000000009` | รองผู้จัดการสาขา | Assistant Branch Manager | 0 | 0.5 | 2 |
| `10000000-0000-0000-0000-000000000010` | ผู้ช่วยแพทย์ | Doctor Assistant | 2 | 1.2 | 20 |
| `10000000-0000-0000-0000-000000000011` | ผู้ประสานงานคลินิก (Clinic Coordination Officer) | Clinic Coordination Officer | 1 | 0.8 | 50 |
| `10000000-0000-0000-0000-000000000012` | ผู้ช่วย Laser Specialist | Laser Specialist Assistant | 1 | 1.0 | 20 |
| `10000000-0000-0000-0000-000000000013` | พนักงานต้อนรับ (Laser Receptionist) | Laser Receptionist | 1 | 0.5 | 40 |
| `10000000-0000-0000-0000-000000000014` | แม่บ้านประจำสาขา | Branch Housekeeper | 1 | 0.3 | 60 |
| `10000000-0000-0000-0000-000000000015` | พยาบาล | Nurse | 2 | 1.0 | 30 |
| `10000000-0000-0000-0000-000000000016` | ผู้ช่วยผู้จัดการสาขา | Assistant Branch Manager | 0 | 0.5 | 2 |
| `10000000-0000-0000-0000-000000000017` | ผู้ช่วยแพทย์ Pico Laser | Doctor Assistant Pico Laser | 1 | 1.2 | 20 |
| `10000000-0000-0000-0000-000000000018` | รองผู้จัดการสาขาและล่าม | Assistant Branch Manager & Interpreter | 0 | 0.6 | 2 |
| `10000000-0000-0000-0000-000000000019` | Front+ล่ามวนสาขา | Front + Interpreter Rotation | 1 | 0.7 | 40 |
| `10000000-0000-0000-0000-000000000020` | ผู้ช่วยแพทย์ Pico | Doctor Assistant Pico | 1 | 1.2 | 20 |
| `10000000-0000-0000-0000-000000000021` | พนักงานต้อนรับ (Pico Laser Receptionist) | Pico Laser Receptionist | 1 | 0.5 | 40 |
| `10000000-0000-0000-0000-000000000022` | ผู้จัดการเขต | District Manager | 0 | 0.0 | 10 |
| `10000000-0000-0000-0000-000000000023` | ผู้จัดการแผนกและกำกับพัฒนาระเบียบสาขา | Department Manager & Branch Development Supervisor | 0 | 0.0 | 10 |
| `10000000-0000-0000-0000-000000000024` | หัวหน้าผู้ช่วยแพทย์ | Head Doctor Assistant | 1 | 1.5 | 15 |
| `10000000-0000-0000-0000-000000000025` | ผู้ช่วยพิเศษ | Special Assistant | 0 | 0.8 | 20 |
| `10000000-0000-0000-0000-000000000026` | ผู้ช่วยแพทย์วนสาขา | Doctor Assistant Rotation | 1 | 1.2 | 20 |
| `10000000-0000-0000-0000-000000000027` | ฟร้อนท์วนสาขา | Front Rotation | 1 | 0.5 | 40 |

---

## Position Categories

### Management Positions
- Branch Manager (English & Thai)
- Assistant Branch Manager (English & Thai variants)
- District Manager (Thai)
- Department Manager & Branch Development Supervisor (Thai)

### Medical/Clinical Positions
- Doctor Assistant (English & Thai variants)
- Head Doctor Assistant (Thai)
- Doctor Assistant Pico Laser (Thai)
- Doctor Assistant Pico (Thai)
- Doctor Assistant Rotation (Thai)
- Nurse (English & Thai)
- Physiotherapist (English)

### Front Desk/Reception Positions
- Front 3 (English) - **NEW**
- Front Laser (English) - **NEW**
- Front+ล่ามวนสาขา (Thai) - Front + Interpreter Rotation
- ฟร้อนท์วนสาขา (Thai) - Front Rotation
- Laser Receptionist (Thai)
- Pico Laser Receptionist (Thai)

### Coordination/Support Positions
- Coordinator (English)
- Service Consultant (English)
- Clinic Coordination Officer (Thai)
- Special Assistant (Thai)

### Laser-Specific Positions
- Laser Assistant (English) - **NEW**
- Laser Specialist Assistant (Thai)

### Other Positions
- Branch Housekeeper (Thai)

---

## Required Positions for Branch Configuration

The following positions are configured in the Branch Configuration UI (`BranchPositionQuotaConfig.tsx`):

1. **Manager** → Matches: "Branch Manager" (English & Thai)
2. **Assistant Manager** → Matches: "Assistant Branch Manager" (English & Thai variants)
3. **Front 3** → Matches: "Front 3" ✅ (exact match)
4. **Coordinator** → Matches: "Coordinator" (English) & "Clinic Coordination Officer" (Thai)
5. **Doctor Assistant** → Matches: "Doctor Assistant" (English & Thai variants)
6. **Nurse** → Matches: "Nurse" (English & Thai)
7. **Physical therapist** → Matches: "Physiotherapist" (English)
8. **Front Laser** → Matches: "Front Laser" ✅ (exact match)
9. **Laser Assistant** → Matches: "Laser Assistant" ✅ (exact match)

---

## Position Matching Logic

The `BranchPositionQuotaConfig` component uses fuzzy matching to find positions:

```typescript
const filteredPositions = positionsData.filter((pos) =>
  targetPositions.some((target) =>
    pos.name.toLowerCase().includes(target.toLowerCase()) ||
    target.toLowerCase().includes(pos.name.toLowerCase())
  )
);
```

This means:
- "Manager" will match "Branch Manager"
- "Assistant Manager" will match "Assistant Branch Manager"
- "Physical therapist" will match "Physiotherapist"
- Exact matches work for "Front 3", "Front Laser", "Laser Assistant"

---

## Notes and Observations

### Duplicates/Similar Positions
1. **Branch Manager** appears twice:
   - English: "Branch Manager"
   - Thai: "ผู้จัดการสาขา"

2. **Assistant Branch Manager** appears multiple times:
   - English: "Assistant Branch Manager"
   - Thai: "รองผู้จัดการสาขา"
   - Thai: "ผู้ช่วยผู้จัดการสาขา"
   - Thai: "รองผู้จัดการสาขาและล่าม" (with interpreter)

3. **Doctor Assistant** has many variants:
   - English: "Doctor Assistant"
   - Thai: "ผู้ช่วยแพทย์"
   - Thai: "ผู้ช่วยแพทย์ Pico Laser"
   - Thai: "ผู้ช่วยแพทย์ Pico"
   - Thai: "ผู้ช่วยแพทย์วนสาขา" (rotation)
   - Thai: "หัวหน้าผู้ช่วยแพทย์" (head)

4. **Front/Reception** positions:
   - "Front 3" (English) - NEW
   - "Front Laser" (English) - NEW
   - "Front+ล่ามวนสาขา" (Thai) - Front + Interpreter Rotation
   - "ฟร้อนท์วนสาขา" (Thai) - Front Rotation
   - "พนักงานต้อนรับ (Laser Receptionist)" (Thai)
   - "พนักงานต้อนรับ (Pico Laser Receptionist)" (Thai)

### Display Order Issues
Some positions have the same display_order value:
- Display Order 1: Branch Manager (English & Thai)
- Display Order 2: Assistant Branch Manager variants
- Display Order 10: District Manager, Department Manager
- Display Order 15: Head Doctor Assistant
- Display Order 20: Doctor Assistant variants, Laser positions
- Display Order 30: Nurse, Physiotherapist
- Display Order 40: Front positions, Receptionists
- Display Order 50: Coordinator, Service Consultant, Clinic Coordination Officer
- Display Order 60: Branch Housekeeper

---

## API Endpoints

### Get All Positions
```
GET /api/positions
```

### Get Position by ID
```
GET /api/positions/:id
```

### Update Position (Admin only)
```
PUT /api/positions/:id
```

### Delete Position (Admin only)
```
DELETE /api/positions/:id
```

**Note:** Positions can only be deleted if they are not associated with any staff members (branch or rotation). If a position has associated staff, the deletion will fail with a 409 Conflict status.

---

## Position Management UI Changes

**As of 2026-01-13:**
- **Removed:** "Min Staff/Branch" field from the Position Management UI (no longer editable)
- **Added:** Two separate columns showing staff allocation counts:
  - "No. of Staff Allocated - Branch" - Count of branch staff assigned to each position (read-only)
  - "No. of Staff Allocated - Rotation" - Count of rotation staff assigned to each position (read-only)
- The `min_staff_per_branch` field remains in the database for backward compatibility but is no longer exposed in the API or UI

## Database Schema

```sql
CREATE TABLE positions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(100) NOT NULL,
    min_staff_per_branch INTEGER DEFAULT 1,  -- Deprecated: kept for backward compatibility, not exposed in API/UI
    revenue_multiplier DECIMAL(10,4) DEFAULT 0,
    display_order INTEGER DEFAULT 999,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**Note:** The Position API response now includes two read-only fields that show staff allocation counts:
- `branch_staff_count` - Number of branch staff members allocated to this position
- `rotation_staff_count` - Number of rotation staff members allocated to this position

These counts are calculated dynamically from the `staff` table, grouped by `staff_type` ('branch' or 'rotation').

---

## Recommendations

1. **Standardize Position Names**: Consider consolidating duplicate positions (English vs Thai) or creating a unified naming system.

2. **Position Categories**: Consider adding a `category` field to group positions (Management, Medical, Front Desk, etc.).

3. **Display Order Review**: Review and standardize display_order values to ensure consistent ordering.

4. **Position Matching**: The fuzzy matching in `BranchPositionQuotaConfig` may match multiple positions. Consider:
   - Using exact position IDs instead of name matching
   - Adding a mapping table for position aliases
   - Improving the matching algorithm

5. **Position Status**: Consider adding an `is_active` field to allow soft-deleting positions without removing them from historical data.

---

## Related Files

- **Database Migration**: `backend/internal/repositories/postgres/migrations.go` (lines 447-480)
- **Domain Model**: `backend/internal/domain/models/staff.go` (Position struct)
- **Handler**: `backend/internal/handlers/position_handler.go`
- **Frontend API**: `frontend/src/lib/api/position.ts`
- **Branch Config Component**: `frontend/src/components/branch/BranchPositionQuotaConfig.tsx`
